(window.webpackJsonp=window.webpackJsonp||[]).push([[49],{295:function(t,s,a){"use strict";a.r(s);var r=a(38),n=Object(r.a)({},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"ueditor-富文本视频上传"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ueditor-富文本视频上传","aria-hidden":"true"}},[t._v("#")]),t._v(" UEditor 富文本视频上传")]),t._v(" "),a("h4",{attrs:{id:"写在前面"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#写在前面","aria-hidden":"true"}},[t._v("#")]),t._v(" 写在前面")]),t._v(" "),a("p",[t._v("我在做 WEB 后台时，富文本组件主要是用百度的 UEditor，本次记录视频上传是各种错误时的 DEBUG 过程。")]),t._v(" "),a("h2",{attrs:{id:"主要过程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#主要过程","aria-hidden":"true"}},[t._v("#")]),t._v(" 主要过程")]),t._v(" "),a("p",[t._v("主要错误：找不到上传文件")]),t._v(" "),a("blockquote",[a("p",[t._v("Ueditor 上传视频的流程")])]),t._v(" "),a("ul",[a("li",[t._v("入口函数是： ueditor/php/controller.php?action=uploadvideo 会引入")]),t._v(" "),a("li",[t._v('在 controller.php 中 action=uploadvideo 会引入 include("action_upload.php");')]),t._v(" "),a("li",[t._v("在 action_upload.php 中 action=uploadvideo 在读取了 config.json 中的配置信息后，会调用 Uploader.class.php")]),t._v(" "),a("li",[t._v("在 Uploader.class.php 根据 uploadvideo 中的配置信息，知道最终调用 upFile() 方法。")])]),t._v(" "),a("p",[t._v("上面就是确定文件上传思路，我遇到的问题是 "),a("strong",[t._v("找不到上传文件")]),t._v("，我用的 Nginx 服务器之前已经遇到过文件大小限制，修改了 nginx 的配置信息，所以这次发现上传文件是 $_FILE 为空，后来发现是 php.ini 中有限制上传文件大小的限制导致了 $_FILE 置空。")]),t._v(" "),a("blockquote",[a("p",[t._v("修改 php.ini")])]),t._v(" "),a("ol",[a("li",[t._v("通过 phpinfo(); 查看 file_uploads 是否开启，如果没有开启打开")]),t._v(" "),a("li",[t._v("查看 upload_max_filesize 到底是多少，我的设置为 32M 于是我统一修改为 100M")]),t._v(" "),a("li",[t._v("查看 post_max_size 是多少，我的设置为 32M 于是我统一修改为 100M")])]),t._v(" "),a("h2",{attrs:{id:"建议"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#建议","aria-hidden":"true"}},[t._v("#")]),t._v(" 建议")]),t._v(" "),a("p",[t._v("Ueditor 上传文件视频大小限时最好统一，即 Ueditor 的 config.json 中的限制、php.ini 限制 以及 nginx 限制都统一，这样才不会出现类似上传文件大小导致的文件上传问题。")]),t._v(" "),a("h2",{attrs:{id:"主要上传的错误信息如下："}},[a("a",{staticClass:"header-anchor",attrs:{href:"#主要上传的错误信息如下：","aria-hidden":"true"}},[t._v("#")]),t._v(" 主要上传的错误信息如下：")]),t._v(" "),a("p",[t._v("主要的错误信息记录在 Ueditor/php/Uploader.class.php 中，主要包括")]),t._v(" "),a("div",{staticClass:"language-php extra-class"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$stateMap")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("array")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//上传状态映射表，国际化用户需考虑此处数据的国际化")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[t._v('"SUCCESS"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//上传成功标记，在UEditor中内不可改变，否则flash判断会出错")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[t._v('"文件大小超出 upload_max_filesize 限制"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[t._v('"文件大小超出 MAX_FILE_SIZE 限制"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[t._v('"文件未被完整上传"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[t._v('"没有文件被上传"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[t._v('"上传文件为空"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[t._v('"ERROR_TMP_FILE"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[t._v('"临时文件错误"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[t._v('"ERROR_TMP_FILE_NOT_FOUND"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[t._v('"找不到临时文件"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[t._v('"ERROR_SIZE_EXCEED"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[t._v('"文件大小超出网站限制"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[t._v('"ERROR_TYPE_NOT_ALLOWED"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[t._v('"文件类型不允许"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[t._v('"ERROR_CREATE_DIR"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[t._v('"目录创建失败"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[t._v('"ERROR_DIR_NOT_WRITEABLE"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[t._v('"目录没有写权限"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[t._v('"ERROR_FILE_MOVE"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[t._v('"文件保存时出错"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[t._v('"ERROR_FILE_NOT_FOUND"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[t._v('"找不到上传文件"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[t._v('"ERROR_WRITE_CONTENT"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[t._v('"写入文件内容错误"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[t._v('"ERROR_UNKNOWN"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[t._v('"未知错误"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[t._v('"ERROR_DEAD_LINK"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[t._v('"链接不可用"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[t._v('"ERROR_HTTP_LINK"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[t._v('"链接不是http链接"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[t._v('"ERROR_HTTP_CONTENTTYPE"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[t._v('"链接contentType不正确"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[t._v('"INVALID_URL"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[t._v('"非法 URL"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[t._v('"INVALID_IP"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[t._v('"非法 IP"')]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])])},[],!1,null,null,null);s.default=n.exports}}]);