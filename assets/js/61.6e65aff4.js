(window.webpackJsonp=window.webpackJsonp||[]).push([[61],{282:function(s,t,a){"use strict";a.r(t);var n=a(38),e=Object(n.a)({},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"linux-下-crontab-学习与使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#linux-下-crontab-学习与使用","aria-hidden":"true"}},[s._v("#")]),s._v(" Linux 下 crontab 学习与使用")]),s._v(" "),a("h3",{attrs:{id:"写在前面"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#写在前面","aria-hidden":"true"}},[s._v("#")]),s._v(" 写在前面")]),s._v(" "),a("blockquote",[a("p",[s._v("crontab 命令用于设置周期性被执行的指令。")])]),s._v(" "),a("h3",{attrs:{id:"一、准备阶段"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一、准备阶段","aria-hidden":"true"}},[s._v("#")]),s._v(" 一、准备阶段")]),s._v(" "),a("ol",[a("li",[s._v("检测 crontab 是否安装")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rpm")]),s._v(" -qa "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("crontab")]),s._v("\n")])])]),a("ol",{attrs:{start:"2"}},[a("li",[s._v("crontab 服务操作")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 开启服务")]),s._v("\n/bin/systemctl start crond\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 关闭服务")]),s._v("\n/bin/systemctl stop crond\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重启服务")]),s._v("\n/bin/systemctl restart crond\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重新载入配置")]),s._v("\n/bin/systemctl reload crond\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 状态")]),s._v("\n/bin/systemctl status crond\n")])])]),a("ol",{attrs:{start:"3"}},[a("li",[s._v("关于 crontab 配置文件")])]),s._v(" "),a("p",[s._v("通过下面命令看到所有存在的 cron 配置文件")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /etc/\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cron")]),s._v("\n\n配置文件 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 功能\n---"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("---\ncron.daily "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 每天执行一次\ncron.weekly "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 每个星期执行一次\ncron.monthly "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 每月执行一次\ncron.hourly "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 每个小时执行一次\ncron.d "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 系统自动定期需要做的任务\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("crontab")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 自定义定时任务执行文件\ncron.deny "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 用于控制不让哪些用户使用Crontab的功能\n")])])]),a("ol",{attrs:{start:"4"}},[a("li",[s._v("crontab 配置文件编写")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("*       *     *    *      *     "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("command")]),s._v("\nminute  hour  day  month  week  "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("command")]),s._v("\n分钟    小时  天   月     星期  命令\n\n命令 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 含义\n---"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("---\nminute "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 表示分钟，可以是从0到59之间的任何整数。\nhour "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 表示小时，可以是从0到23之间的任何整数。\nday "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 表示日期，可以是从1到31之间的任何整数。\nmonth "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 表示月份，可以是从1到12之间的任何整数。\nweek "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 表示星期几，可以是从0到7之间的任何整数，这里的0或7代表星期日。\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("command")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 要执行的命令，可以是系统命令，也可以是自己编写的脚本文件。\n")])])]),a("ul",[a("li",[s._v("特殊字符")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("命令 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 含义\n---"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("---\n星号（*） "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 代表所有可能的值，例如month字段如果是星号，则表示在满足其它字段的制约条件后每月都执行该命令操作。\n逗号（,） "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 可以用逗号隔开的值指定一个列表范围，例如，“1,2,5,7,8,9”。\n中杠（-） "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 可以用整数之间的中杠表示一个整数范围，例如“2-6”表示“2,3,4,5,6”。\n正斜线（/） "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 可以用正斜线指定时间的间隔频率，例如“0-23/2”表示每两小时执行一次。同时正斜线可以和星号一起使用，例如*/10，如果用在minute字段，表示每十分钟执行一次。\n")])])]),a("ol",{attrs:{start:"5"}},[a("li",[s._v("实战：编写一个执行命令")])]),s._v(" "),a("blockquote",[a("p",[s._v("目标：每分钟执行一次我写好的 PHP 命令")])]),s._v(" "),a("ul",[a("li",[s._v("创建一个 shell 执行文件，执行 PHP 任务")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("// 创建一个叫做：web.min.sh 文件\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("touch")]),s._v(" web.min.sh\n// 编辑文件\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" web.min.sh\n// 录入如下内容\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#!/usr/bin/env bash")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /home/wwwroot/www.noasis.cn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# php index.php welcome send_test;")]),s._v("\n\n")])])]),a("ul",[a("li",[s._v("赋权 脚本文件 并 测试")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" +x web.min.sh\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sh")]),s._v(" web.min.sh\n// 如果获得预期的结果，则说明脚本没有问题\n")])])]),a("ul",[a("li",[s._v("添加计划任务")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("// 添加用户定时任务\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("crontab")]),s._v(" -e\n* * * * * /home/web.min.sh\n// 列出当前用户定时任务\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("crontab")]),s._v(" -l\n// 删除当前用户定时任务\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("crontab")]),s._v(" -r\n")])])]),a("ol",{attrs:{start:"6"}},[a("li",[s._v("crond 开启启动")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("// 检测是否开启启动\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chkconfig")]),s._v(" --list crond\n// 设置开机启动\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chkconfig")]),s._v(" --level "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("35")]),s._v(" crond on \n")])])])])},[],!1,null,null,null);t.default=e.exports}}]);