<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>SpringBoot 中接口规范 | zZ爱吃菜</title>
    <meta name="description" content="记录开发，记录生活">
    <link rel="icon" href="/img/logo.jpg">
  <link rel="stylesheet" href="/css/style.css">
  <script charset="utf-8" src="/js/main.js"></script>
    
    <link rel="preload" href="/assets/css/0.styles.626fedcf.css" as="style"><link rel="preload" href="/assets/js/app.d9b0a8be.js" as="script"><link rel="preload" href="/assets/js/2.dfeefe94.js" as="script"><link rel="preload" href="/assets/js/31.c0466e6c.js" as="script"><link rel="prefetch" href="/assets/js/10.e7a674a5.js"><link rel="prefetch" href="/assets/js/11.4c8bf6d5.js"><link rel="prefetch" href="/assets/js/12.4e0fd2f1.js"><link rel="prefetch" href="/assets/js/13.e8c8f626.js"><link rel="prefetch" href="/assets/js/14.10696f84.js"><link rel="prefetch" href="/assets/js/15.f8a89e08.js"><link rel="prefetch" href="/assets/js/16.1eb5263d.js"><link rel="prefetch" href="/assets/js/17.4ddc1a01.js"><link rel="prefetch" href="/assets/js/18.c9fd674d.js"><link rel="prefetch" href="/assets/js/19.c2c69591.js"><link rel="prefetch" href="/assets/js/20.65d01b8c.js"><link rel="prefetch" href="/assets/js/21.e6d01b88.js"><link rel="prefetch" href="/assets/js/22.33adbd14.js"><link rel="prefetch" href="/assets/js/23.118165f1.js"><link rel="prefetch" href="/assets/js/24.ada5e265.js"><link rel="prefetch" href="/assets/js/25.f0ed3bf8.js"><link rel="prefetch" href="/assets/js/26.e32e4e04.js"><link rel="prefetch" href="/assets/js/27.bd826510.js"><link rel="prefetch" href="/assets/js/28.99d06e23.js"><link rel="prefetch" href="/assets/js/29.5b4419ec.js"><link rel="prefetch" href="/assets/js/3.a78a1311.js"><link rel="prefetch" href="/assets/js/30.b2cb92b1.js"><link rel="prefetch" href="/assets/js/32.e184aa1f.js"><link rel="prefetch" href="/assets/js/33.7a83e3fe.js"><link rel="prefetch" href="/assets/js/34.1951b7b7.js"><link rel="prefetch" href="/assets/js/35.d76d9386.js"><link rel="prefetch" href="/assets/js/36.72f6a253.js"><link rel="prefetch" href="/assets/js/37.bf4d697b.js"><link rel="prefetch" href="/assets/js/38.bbb2dce8.js"><link rel="prefetch" href="/assets/js/39.26c29e6f.js"><link rel="prefetch" href="/assets/js/4.a640192c.js"><link rel="prefetch" href="/assets/js/40.8355738f.js"><link rel="prefetch" href="/assets/js/41.e1f1230b.js"><link rel="prefetch" href="/assets/js/42.d4a8991e.js"><link rel="prefetch" href="/assets/js/43.cb8a7199.js"><link rel="prefetch" href="/assets/js/44.f2da1d0c.js"><link rel="prefetch" href="/assets/js/45.b95d08b5.js"><link rel="prefetch" href="/assets/js/46.e0cea998.js"><link rel="prefetch" href="/assets/js/47.d9461b52.js"><link rel="prefetch" href="/assets/js/48.61786f7c.js"><link rel="prefetch" href="/assets/js/49.3987afca.js"><link rel="prefetch" href="/assets/js/5.d7099aa7.js"><link rel="prefetch" href="/assets/js/50.159bf9af.js"><link rel="prefetch" href="/assets/js/51.d6ad7976.js"><link rel="prefetch" href="/assets/js/52.3c9d6bb6.js"><link rel="prefetch" href="/assets/js/53.457392fd.js"><link rel="prefetch" href="/assets/js/54.289f8965.js"><link rel="prefetch" href="/assets/js/55.7bea2695.js"><link rel="prefetch" href="/assets/js/56.b0d493cc.js"><link rel="prefetch" href="/assets/js/57.9ad7f812.js"><link rel="prefetch" href="/assets/js/58.ba4cb581.js"><link rel="prefetch" href="/assets/js/59.7b6814b7.js"><link rel="prefetch" href="/assets/js/6.10be9919.js"><link rel="prefetch" href="/assets/js/60.f757e747.js"><link rel="prefetch" href="/assets/js/61.6e65aff4.js"><link rel="prefetch" href="/assets/js/62.ed989088.js"><link rel="prefetch" href="/assets/js/63.fcf0b41d.js"><link rel="prefetch" href="/assets/js/64.eac23bf1.js"><link rel="prefetch" href="/assets/js/65.5503d6c5.js"><link rel="prefetch" href="/assets/js/66.03f5104b.js"><link rel="prefetch" href="/assets/js/67.48e84939.js"><link rel="prefetch" href="/assets/js/68.2ed028b5.js"><link rel="prefetch" href="/assets/js/7.c17c72ee.js"><link rel="prefetch" href="/assets/js/8.593bcd4c.js"><link rel="prefetch" href="/assets/js/9.3d01efee.js">
    <link rel="stylesheet" href="/assets/css/0.styles.626fedcf.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">zZ爱吃菜</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">随笔记</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>后端</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/notebook/php/" class="nav-link">PHP</a></li><li class="dropdown-subitem"><a href="/notebook/mysql/" class="nav-link">MySQL</a></li><li class="dropdown-subitem"><a href="/notebook/java/" class="nav-link router-link-active">JAVA</a></li><li class="dropdown-subitem"><a href="/notebook/server/" class="nav-link">服务器</a></li></ul></li><li class="dropdown-item"><h4>前端</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/notebook/js/" class="nav-link">Javascript</a></li><li class="dropdown-subitem"><a href="/notebook/css/" class="nav-link">CSS</a></li><li class="dropdown-subitem"><a href="/notebook/flutter/" class="nav-link">Flutter</a></li><li class="dropdown-subitem"><a href="/notebook/ios/" class="nav-link">iOS</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">进阶之路</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/advance/oop/" class="nav-link">PHP面向对象编程</a></li><li class="dropdown-item"><!----> <a href="/advance/cit/" class="nav-link">CIT框架设计</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">我的项目</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/project/lwadmin/" class="nav-link">LW.ADMIN</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">工具箱</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>在线编辑</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://tinypng.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  图片压缩
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li><li class="dropdown-item"><h4>在线服务</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://www.aliyun.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  阿里云
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://cloud.tencent.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  腾讯云
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li><li class="dropdown-item"><h4>博客指南</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://juejin.im/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  掘金
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://blog.csdn.net/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  CSDN
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">随笔记</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>后端</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/notebook/php/" class="nav-link">PHP</a></li><li class="dropdown-subitem"><a href="/notebook/mysql/" class="nav-link">MySQL</a></li><li class="dropdown-subitem"><a href="/notebook/java/" class="nav-link router-link-active">JAVA</a></li><li class="dropdown-subitem"><a href="/notebook/server/" class="nav-link">服务器</a></li></ul></li><li class="dropdown-item"><h4>前端</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/notebook/js/" class="nav-link">Javascript</a></li><li class="dropdown-subitem"><a href="/notebook/css/" class="nav-link">CSS</a></li><li class="dropdown-subitem"><a href="/notebook/flutter/" class="nav-link">Flutter</a></li><li class="dropdown-subitem"><a href="/notebook/ios/" class="nav-link">iOS</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">进阶之路</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/advance/oop/" class="nav-link">PHP面向对象编程</a></li><li class="dropdown-item"><!----> <a href="/advance/cit/" class="nav-link">CIT框架设计</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">我的项目</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/project/lwadmin/" class="nav-link">LW.ADMIN</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">工具箱</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>在线编辑</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://tinypng.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  图片压缩
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li><li class="dropdown-item"><h4>在线服务</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://www.aliyun.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  阿里云
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://cloud.tencent.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  腾讯云
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li><li class="dropdown-item"><h4>博客指南</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://juejin.im/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  掘金
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://blog.csdn.net/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  CSDN
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>JAVA 学习</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/notebook/java/1/SpringBoot入门.html" class="sidebar-link">SpringBoot 入门</a></li><li><a href="/notebook/java/2/SpringBoot接口规范.html" class="active sidebar-link">SpringBoot 中接口规范</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notebook/java/2/SpringBoot接口规范.html#一、接口请求参数方式" class="sidebar-link">一、接口请求参数方式</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notebook/java/2/SpringBoot接口规范.html#_1-form-urlencoded" class="sidebar-link">1. form-urlencoded</a></li><li class="sidebar-sub-header"><a href="/notebook/java/2/SpringBoot接口规范.html#_2-application-json" class="sidebar-link">2. application/json</a></li></ul></li><li class="sidebar-sub-header"><a href="/notebook/java/2/SpringBoot接口规范.html#二、接口返回" class="sidebar-link">二、接口返回</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notebook/java/2/SpringBoot接口规范.html#_1-常规返回标准化接口数据" class="sidebar-link">1. 常规返回标准化接口数据</a></li><li class="sidebar-sub-header"><a href="/notebook/java/2/SpringBoot接口规范.html#_2-实现标准版接口返回数据" class="sidebar-link">2.实现标准版接口返回数据</a></li></ul></li><li class="sidebar-sub-header"><a href="/notebook/java/2/SpringBoot接口规范.html#三、表单验证" class="sidebar-link">三、表单验证</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notebook/java/2/SpringBoot接口规范.html#_1-创建一个表单类" class="sidebar-link">1. 创建一个表单类</a></li><li class="sidebar-sub-header"><a href="/notebook/java/2/SpringBoot接口规范.html#_2-controller-校验" class="sidebar-link">2. Controller 校验</a></li><li class="sidebar-sub-header"><a href="/notebook/java/2/SpringBoot接口规范.html#_3-最后重载一下-responsevo-的-error-方法，" class="sidebar-link">3. 最后重载一下 ResponseVo 的 error 方法，</a></li><li class="sidebar-sub-header"><a href="/notebook/java/2/SpringBoot接口规范.html#_4-最终错误参数接口输出结果" class="sidebar-link">4.最终错误参数接口输出结果</a></li><li class="sidebar-sub-header"><a href="/notebook/java/2/SpringBoot接口规范.html#总结" class="sidebar-link">总结</a></li></ul></li><li class="sidebar-sub-header"><a href="/notebook/java/2/SpringBoot接口规范.html#四、运行时错误，统一输出-json" class="sidebar-link">四、运行时错误，统一输出 JSON</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notebook/java/2/SpringBoot接口规范.html#_1-模拟一个运行时错误" class="sidebar-link">1. 模拟一个运行时错误</a></li><li class="sidebar-sub-header"><a href="/notebook/java/2/SpringBoot接口规范.html#_2-通过设置异常处理类统一返回结果" class="sidebar-link">2.通过设置异常处理类统一返回结果</a></li></ul></li><li class="sidebar-sub-header"><a href="/notebook/java/2/SpringBoot接口规范.html#五、session-和-cookie" class="sidebar-link">五、Session 和 Cookie</a></li><li class="sidebar-sub-header"><a href="/notebook/java/2/SpringBoot接口规范.html#未完待续" class="sidebar-link">未完待续</a></li><li class="sidebar-sub-header"><a href="/notebook/java/2/SpringBoot接口规范.html#最后说两句" class="sidebar-link">最后说两句</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="springboot-中接口规范"><a href="#springboot-中接口规范" aria-hidden="true" class="header-anchor">#</a> SpringBoot 中接口规范</h1> <p>本文主要记录，我在学习使用 SpringBoot 开发接口的一些技巧</p> <h2 id="一、接口请求参数方式"><a href="#一、接口请求参数方式" aria-hidden="true" class="header-anchor">#</a> 一、接口请求参数方式</h2> <p>目前主流的请求参数有两种：form-urlencoded 和 application/json（大佬推荐），两种不同的方式 JAVA 端读取参数的方式略有不同</p> <h3 id="_1-form-urlencoded"><a href="#_1-form-urlencoded" aria-hidden="true" class="header-anchor">#</a> 1. form-urlencoded</h3> <blockquote><p>Content-Type:application/x-www-form-urlencoded</p></blockquote> <p>参数类型，主要是通过：键值对传递，例如：username: 'zZ爱吃菜'</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">&quot;key&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">register</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span> <span class="token class-name">String</span> username<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 推荐使用日志模式输入内容</span>
  log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;username={}&quot;</span><span class="token punctuation">,</span> username<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 接受参数的方式</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">register</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span> <span class="token class-name">String</span> username<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 推荐使用日志模式输入内容</span>
  log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;username={}&quot;</span><span class="token punctuation">,</span> username<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 参数重命名， 同上</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">register</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">&quot;username&quot;</span><span class="token punctuation">)</span> <span class="token class-name">String</span> userName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 推荐使用日志模式输入内容</span>
  log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;username={}&quot;</span><span class="token punctuation">,</span> userName<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 直接将参数复制给一个对象，前提参数名与对象属性名对应</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">register</span><span class="token punctuation">(</span><span class="token class-name">User</span> user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 推荐使用日志模式输入内容</span>
  log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;username={}&quot;</span><span class="token punctuation">,</span> user<span class="token punctuation">.</span><span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_2-application-json"><a href="#_2-application-json" aria-hidden="true" class="header-anchor">#</a> 2. application/json</h3> <blockquote><p>Content-Type:application/json</p></blockquote> <p>参数形式： json 形式</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
	<span class="token property">&quot;username&quot;</span><span class="token operator">:</span> <span class="token string">&quot;zZ 爱吃菜&quot;</span><span class="token punctuation">,</span>
	<span class="token property">&quot;password&quot;</span><span class="token operator">:</span> <span class="token string">&quot;123123&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>java 接收，需要增加 @RequestBody 注解，来接收</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// 如果是 Post 方式 Content-Type: application/json，则使用@RequestBody 方式接收参数</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">register</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">User</span> user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 推荐使用日志模式输入内容</span>
  log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;username={}&quot;</span><span class="token punctuation">,</span> user<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="二、接口返回"><a href="#二、接口返回" aria-hidden="true" class="header-anchor">#</a> 二、接口返回</h2> <p>在制作接口通常都是放回 JSON 数据给前端</p> <blockquote><p>SpringBoot 有专门的注解返回 JSON</p></blockquote> <p>以前：@Controller + @ResponseBody</p> <p>现在：@RestController 即可</p> <h3 id="_1-常规返回标准化接口数据"><a href="#_1-常规返回标准化接口数据" aria-hidden="true" class="header-anchor">#</a> 1. 常规返回标准化接口数据</h3> <p>通常的标准化接口数据格式如下</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token comment">// 正确返回值</span>
<span class="token punctuation">{</span>
    <span class="token property">&quot;status&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">&quot;msg&quot;</span><span class="token operator">:</span> <span class="token string">&quot;***操作成功&quot;</span><span class="token punctuation">,</span>
  	<span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;value&quot;</span><span class="token punctuation">,</span>
      ...
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 专属错误返回值</span>
<span class="token punctuation">{</span>
    <span class="token property">&quot;status&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token property">&quot;msg&quot;</span><span class="token operator">:</span> <span class="token string">&quot;用户未登录，请先登录&quot;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 错误返回值（通用）</span>
<span class="token punctuation">{</span>
    <span class="token property">&quot;status&quot;</span><span class="token operator">:</span> <span class="token number">-1</span><span class="token punctuation">,</span>
    <span class="token property">&quot;msg&quot;</span><span class="token operator">:</span> <span class="token string">&quot;系统错误&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_2-实现标准版接口返回数据"><a href="#_2-实现标准版接口返回数据" aria-hidden="true" class="header-anchor">#</a> 2.实现标准版接口返回数据</h3> <p>在项目下，创建 vo 包（view object缩写），创建 ResponseVo.java 类</p> <blockquote><p>构建通用的 接口返回内容模块，另外需要跟 接口返回状态 status 对应的枚举匹配</p></blockquote> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>imooc<span class="token punctuation">.</span>mall<span class="token punctuation">.</span>vo</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>fasterxml<span class="token punctuation">.</span>jackson<span class="token punctuation">.</span>annotation</span><span class="token punctuation">.</span><span class="token class-name">JsonInclude</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>imooc<span class="token punctuation">.</span>mall<span class="token punctuation">.</span>enums</span><span class="token punctuation">.</span><span class="token class-name">ResponseEnum</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> lombok<span class="token punctuation">.</span><span class="token class-name">Data</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Data</span>
<span class="token comment">//@JsonSerialize</span>
<span class="token comment">// 让 json 接口返回的 null 隐藏掉</span>
<span class="token annotation punctuation">@JsonInclude</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token class-name">JsonInclude</span><span class="token punctuation">.</span><span class="token class-name">Include</span><span class="token punctuation">.</span>NON_NULL<span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ResponseVo</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">Integer</span> status<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> msg<span class="token punctuation">;</span>

    <span class="token comment">// data 数据不确定，所以使用 泛型</span>
    <span class="token keyword">private</span> <span class="token class-name">T</span> data<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">ResponseVo</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> status<span class="token punctuation">,</span> <span class="token class-name">String</span> msg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>status <span class="token operator">=</span> status<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>msg <span class="token operator">=</span> msg<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 指定msg 成功返回结果</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">ResponseVo</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token function">success</span><span class="token punctuation">(</span><span class="token class-name">String</span> msg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ResponseVo</span><span class="token punctuation">(</span><span class="token class-name">ResponseEnum</span><span class="token punctuation">.</span>SUCCESS<span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 默认成功返回结果</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">ResponseVo</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token function">success</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ResponseVo</span><span class="token punctuation">(</span><span class="token class-name">ResponseEnum</span><span class="token punctuation">.</span>SUCCESS<span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">ResponseEnum</span><span class="token punctuation">.</span>SUCCESS<span class="token punctuation">.</span><span class="token function">getDesc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 错误内容返回</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">ResponseVo</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token function">error</span><span class="token punctuation">(</span><span class="token class-name">ResponseEnum</span> responseEnum<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ResponseVo</span><span class="token punctuation">(</span>responseEnum<span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> responseEnum<span class="token punctuation">.</span><span class="token function">getDesc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>接口状态枚举累 ResponseEnum</p></blockquote> <p>注意：枚举状态中的状态码，没必要跟我一致，我这里也是根据课程内容写的，具体开发阶段还是需要自己跟前端开发工程师去沟通。因为接口是给前端交互的，而不是满足自己的。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>imooc<span class="token punctuation">.</span>mall<span class="token punctuation">.</span>enums</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> lombok<span class="token punctuation">.</span><span class="token class-name">Getter</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Getter</span>
<span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">ResponseEnum</span> <span class="token punctuation">{</span>

    <span class="token function">ERROR</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;服务端错误&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

    <span class="token function">SUCCESS</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">&quot;成功&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

    <span class="token function">PASSWORD_ERROR</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;密码错误&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

    <span class="token function">USER_EXIST</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&quot;用户 已存在&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

    <span class="token function">NEED_LOGIN</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">&quot;用户未登录，请先登录&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">;</span>

    <span class="token class-name">Integer</span> code<span class="token punctuation">;</span>

    <span class="token class-name">String</span> desc<span class="token punctuation">;</span>

    <span class="token class-name">ResponseEnum</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> code<span class="token punctuation">,</span> <span class="token class-name">String</span> desc<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>code <span class="token operator">=</span> code<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>desc <span class="token operator">=</span> desc<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>最近简单在 Controller 中调用一下</p></blockquote> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// 实现接口返回 JSON 格式</span>
<span class="token annotation punctuation">@RestController</span>
<span class="token comment">// 定义 Controller 请求路径</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/user&quot;</span><span class="token punctuation">)</span>
<span class="token comment">// 日志打印注解，开发阶段很需要</span>
<span class="token annotation punctuation">@Slf4j</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserController</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;/register&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">ResponseVo</span> <span class="token function">register</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">User</span> user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 推荐使用日志模式输入内容</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;username={}&quot;</span><span class="token punctuation">,</span> user<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//return ResponseVo.success();</span>
        <span class="token keyword">return</span> <span class="token class-name">ResponseVo</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>NEED_LOGIN<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="三、表单验证"><a href="#三、表单验证" aria-hidden="true" class="header-anchor">#</a> 三、表单验证</h2> <p>一般接口都会接收参数，那么我们需要怎么校验没个参数是否接收到呢？</p> <p>答：为每个接口增加一个表单类，用来控制每个参数是否为必须参数</p> <blockquote><p>以用户注册为例</p></blockquote> <h3 id="_1-创建一个表单类"><a href="#_1-创建一个表单类" aria-hidden="true" class="header-anchor">#</a> 1. 创建一个表单类</h3> <p>通常表单类，放在 form 包下： src/main/java/<em><strong>工程名</strong></em>/form/</p> <p>注意：如下注解对应不同字段即不同参数的要求。</p> <p>@NotBlank // 用户 String 判断空格
@NotEmpty // 用于集合
@NotNull // 参数不能为 null , 可以为空字符串</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">import</span> lombok<span class="token punctuation">.</span><span class="token class-name">Data</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>validation<span class="token punctuation">.</span>constraints</span><span class="token punctuation">.</span><span class="token class-name">NotBlank</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserForm</span> <span class="token punctuation">{</span>

    <span class="token comment">// @NotBlank 用户 String 判断空格</span>
    <span class="token comment">// @NotEmpty // 用于集合</span>
    <span class="token comment">// @NotNull</span>
    <span class="token annotation punctuation">@NotBlank</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">&quot;用户名不能为空&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> username<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@NotBlank</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">&quot;用户密码不能为空&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> password<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@NotBlank</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">&quot;用户邮箱不能为空&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> email<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_2-controller-校验"><a href="#_2-controller-校验" aria-hidden="true" class="header-anchor">#</a> 2. Controller 校验</h3> <p>重点：@Valid + BindingResult  实现对 UserForm 接口参数表单内容的校验</p> <p>UserForm 来接收 接口发来的参数（@RequestBody 中的参数），@Valid 注解帮助我们获取到 UserForm 参数是否符合要求，通过  BindingResult 输出是否有错误</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/user&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Slf4j</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserController</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">IUserService</span> userService<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;/register&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">ResponseVo</span> <span class="token function">register</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Valid</span> <span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">UserForm</span> userForm<span class="token punctuation">,</span>
                               <span class="token class-name">BindingResult</span> bindingResult<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 表单校验</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>bindingResult<span class="token punctuation">.</span><span class="token function">hasErrors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          	log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&quot;注册提交的参数有误, {} {}&quot;</span><span class="token punctuation">,</span>
                    bindingResult<span class="token punctuation">.</span><span class="token function">getFieldError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getField</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    bindingResult<span class="token punctuation">.</span><span class="token function">getFieldError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getDefaultMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token class-name">ResponseVo</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>PARAM_ERROR<span class="token punctuation">,</span> bindingResult<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">User</span> user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">BeanUtils</span><span class="token punctuation">.</span><span class="token function">copyProperties</span><span class="token punctuation">(</span>userForm<span class="token punctuation">,</span> user<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> userService<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><table><thead><tr><th>方法</th> <th>描述</th></tr></thead> <tbody><tr><td>bindingResult.getFieldError().getField()</td> <td>获取不符合要求的字段</td></tr> <tr><td>bindingResult.getFieldError().getDefaultMessage()</td> <td>输入字段描述的错误信息， 对应 @NotBlank(message = &quot;用户名不能为空&quot;)</td></tr></tbody></table> <h3 id="_3-最后重载一下-responsevo-的-error-方法，"><a href="#_3-最后重载一下-responsevo-的-error-方法，" aria-hidden="true" class="header-anchor">#</a> 3. 最后重载一下 ResponseVo 的 error 方法，</h3> <p>实现自动对 bindingResult 输出</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">ResponseVo</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token function">error</span><span class="token punctuation">(</span><span class="token class-name">ResponseEnum</span> responseEnum<span class="token punctuation">,</span> <span class="token class-name">BindingResult</span> bindingResult<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ResponseVo</span><span class="token punctuation">(</span>responseEnum<span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> responseEnum<span class="token punctuation">.</span><span class="token function">getDesc</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;：&quot;</span> <span class="token operator">+</span> <span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">requireNonNull</span><span class="token punctuation">(</span>bindingResult<span class="token punctuation">.</span><span class="token function">getFieldError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getField</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; &quot;</span> <span class="token operator">+</span> bindingResult<span class="token punctuation">.</span><span class="token function">getFieldError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getDefaultMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre></div><h3 id="_4-最终错误参数接口输出结果"><a href="#_4-最终错误参数接口输出结果" aria-hidden="true" class="header-anchor">#</a> 4.最终错误参数接口输出结果</h3> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;status&quot;</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
    <span class="token property">&quot;msg&quot;</span><span class="token operator">:</span> <span class="token string">&quot;邮箱已存在&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="总结"><a href="#总结" aria-hidden="true" class="header-anchor">#</a> 总结</h3> <p>不论接口参数多少，都可以统一在接口参数表单类里进行设置 判断条件（通过注解）并设置默认错误信息，然后即可以统一使用 @Valid + BindingResult + ResponseVo 输出错误结果，提高代码的简洁度和可读性，降低代码的耦合度。</p> <h2 id="四、运行时错误，统一输出-json"><a href="#四、运行时错误，统一输出-json" aria-hidden="true" class="header-anchor">#</a> 四、运行时错误，统一输出 JSON</h2> <p>在请求结果执行的过程中如果返现 throw new RuntimeException(“****”); 不可控的错误时，该如何友好的让前端获取到呢？这就需要查看一下如真的有异常输出，前端获取的 json 格式是怎么样的。</p> <h3 id="_1-模拟一个运行时错误"><a href="#_1-模拟一个运行时错误" aria-hidden="true" class="header-anchor">#</a> 1. 模拟一个运行时错误</h3> <p>加入我们在 Service 层增加一个抛出 RuntimeException 的方法，并被调用。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// 模拟一个异常操作，然后输出错误</span>
<span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">testError</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">&quot;意外错误&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token class-name">ResponseVo</span> <span class="token function">register</span><span class="token punctuation">(</span><span class="token class-name">User</span> user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 测试异常</span>
  <span class="token function">testError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">/// 下面时注册逻辑；</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>接口返回的结果</p></blockquote> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;timestamp&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2020-04-21T14:51:21.840+0000&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;status&quot;</span><span class="token operator">:</span> <span class="token number">500</span><span class="token punctuation">,</span>
    <span class="token property">&quot;error&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Internal Server Error&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;message&quot;</span><span class="token operator">:</span> <span class="token string">&quot;意外错误&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/user/register&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>看看吧，接口返回的内容 跟 我们与前端沟通的格式不同，前端同事会崩溃的~</p> <h3 id="_2-通过设置异常处理类统一返回结果"><a href="#_2-通过设置异常处理类统一返回结果" aria-hidden="true" class="header-anchor">#</a> 2.通过设置异常处理类统一返回结果</h3> <p>创建一个 exception 包，并创建 RuntimeExceptionHandle 类 专门处理这些异常错误，并统一返回 json 格式</p> <p>我的理解，这是通过拦截异常错误，获取错误内容，自己结合 ResponseVo 返回我们约定的 json 格式</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@ControllerAdvice</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RuntimeExceptionHandle</span> <span class="token punctuation">{</span>

    <span class="token comment">// 通过捕获异常，将运行时异常的输出与我们通用 API 返回 JSON 格式统一起来</span>
    <span class="token annotation punctuation">@ExceptionHandler</span><span class="token punctuation">(</span><span class="token class-name">RuntimeException</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@ResponseBody</span> <span class="token comment">// 用于返回 json 数据</span>
    <span class="token comment">//@ResponseStatus(HttpStatus.ACCEPTED) // 控制返回状态码</span>
    <span class="token keyword">public</span> <span class="token class-name">ResponseVo</span> <span class="token function">handle</span><span class="token punctuation">(</span><span class="token class-name">RuntimeException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">ResponseVo</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token class-name">ResponseEnum</span><span class="token punctuation">.</span>ERROR<span class="token punctuation">,</span> e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>返回的 json 数据</p></blockquote> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;status&quot;</span><span class="token operator">:</span> <span class="token number">-1</span><span class="token punctuation">,</span>
    <span class="token property">&quot;msg&quot;</span><span class="token operator">:</span> <span class="token string">&quot;服务端错误：意外错误&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="五、session-和-cookie"><a href="#五、session-和-cookie" aria-hidden="true" class="header-anchor">#</a> 五、Session 和 Cookie</h2> <p>在 Controller 中增加  HttpSession session 参数即可获得，session 对象，通过 session.setAttribute(key, value) session.getAttribute(key) 方式 设置session 和 读取。</p> <blockquote><p>session 和 cookie 的关系</p></blockquote> <ul><li>session 存储在服务器，session.getId() 同 下面 cookie 对应</li> <li>cookie 存储在客户端，内容为：JSESSIONID=0E245BE27CB3AE565CA68F004879ED9D</li> <li>cookie 存储注意 跨域问题，即 domain， 比如 localhost 和 127.0.0.1 发同一个请求， JSESSIONID 是不同的</li></ul> <h2 id="未完待续"><a href="#未完待续" aria-hidden="true" class="header-anchor">#</a> 未完待续</h2> <ul><li>session + cookie</li> <li>接口统一校验 等</li></ul> <h2 id="最后说两句"><a href="#最后说两句" aria-hidden="true" class="header-anchor">#</a> 最后说两句</h2> <p>其实已经开发了很多年了，不过都是其他技术栈（PHP+iOS+Flutter），这次在使用 SpringBoot 开发过程中，发现通过相对规范的方式开发系统，其实不会增加代码量和工作量，而且可以使项目更容易理解与维护。</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">4/22/2020, 9:50:47 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/notebook/java/1/SpringBoot入门.html" class="prev">
          SpringBoot 入门
        </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.d9b0a8be.js" defer></script><script src="/assets/js/2.dfeefe94.js" defer></script><script src="/assets/js/31.c0466e6c.js" defer></script>
  </body>
</html>
